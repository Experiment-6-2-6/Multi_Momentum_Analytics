---
title: "Methodology"
author: "Kristoff Dudek"
date: "2022-11-26"
output: html_document
---
*This document is a record of my thought processes and work path I have chosen for my analysis. For the stakeholder version of the report please see MM_ETF_Report*

# Introduction
The mine goal of this work is an automation of all weekly tasks associated with managing my investment portfolio.

# Assumptions and goals
* All data should be pulled from public, free sources.
* All the ETFs are listed in GBX (British Pennies - standard on London Stock Exchange)
* The report should be in a form of summary of the situation and recommendation (in PDF format)
* I want to see one year of weekly momentum in the report.
* Additionally, I need the weekly ETF momentum calculations added every week to my Google Sheets.
* For obvious security reason I can't publish my Google credential here so the outcomes will be stored in my local SQL database.
* There is no data for SGLN ETF available on Yahoo Finance I need some substitute for it.
* In the final report should be only 3 top momentum ETFs with global bonds and phisical gold (5 in total)
* The top one is recommended but not if a failsafe rule is triggered.
* As the failsafe rule I am going to use 30 weeks Exponential Moving Average EMA(30). Asset under it can not be recommended and if all are in negative then going to cash should be advised.


## Setting Up The Environment

I am using three packages:
* Quantmod for quantitative analyse
* Tidyverse for general data manipulation
* DBI for working with databases
At the moment, for the simplicity, I am going to work with a virtual DB (in memory only) and because my current employer uses SQLite I ma going to practice it here.

```{r}
install.packages("quantmod")
install.packages("tidyverse")
install.packages("RSQLite")
library(quantmod)
library(tidyverse)
library(dplyr)
library(RSQLite)
#library(DBI) probably in RSQLite
```
Preparing an auxiliary data frame
```{r}
ticker <- read_csv("ETFs.csv", col_names = FALSE, show_col_types = FALSE)  %>% as.character()
inYahoo <- paste0(ETF_names, ".L")
momentum <- numeric(length(tickers))
df <- data.frame(ticker, inYahoo, momentum)
```
Preparing the SQL database
```{r}
connection <- dbConnect(RSQLite::SQLite(), ":memory:")
getSymbols(inYahoo, from = Sys.Date() - 800) #working here
```
